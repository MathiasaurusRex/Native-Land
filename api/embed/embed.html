<!-- Embed code -->
<!DOCTYPE html>
<html lang="en">
<head>
    <title>Native-land.ca | API Endpoint</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
      <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
      <link rel="icon" href="/images/favicon.png" type="image/x-icon"/>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.css" />

    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
    <style>
        body, html {
            padding: 0;
            margin: 0;
        }
        a {
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div id="nativeLandMap" class="nativeLandMap" style="width:100%;height:300px;"></div>
</body>
<script src="http://cdn.leafletjs.com/leaflet/v0.7.7/leaflet.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="../../js/fromgeojson.js"></script>
<script src="../../js/underscore-min.js"></script>
<script src="../../coordinates/indigenousLanguages.js"></script>
<script src="../../coordinates/indigenousTerritories.js"></script>
<script src="../../coordinates/indigenousTreaties.js"></script>
<script>
    $(document).ready(function() {
      $('#nativeLandMap').height(window.innerHeight);

      var afterQuestionMark = window.location.href.substr(window.location.href.indexOf("?") + 1);
      $.get( "../index.php?"+afterQuestionMark, function( data ) {
          var map = L.map('nativeLandMap').setView([51.505, -0.09], 13);
          L.tileLayer( 'http://{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png', {
              attribution: false,
              subdomains: ['otile1','otile2','otile3','otile4']
          }).addTo( map );
          map.attributionControl.setPrefix('Improve this map! Visit <a target="_blank" href="http://native-land.ca">Native-Land.ca</a>')
          var allGeoJsons = [];
          data.forEach(function(element,index,array) {
              var thisGeoJson = L.geoJson(element,{
                  onEachFeature: function(feature, layer) {
                      layer.bindPopup('<a target="_blank" href="'+feature.properties.description+'">'+feature.properties.Name+'</a>');
                  },
                  style: function(feature) {
                      const color = getRandomColor();
                      return {
                          opacity: 0.8,
                          color: '#333',
                          weight : 0.1,
                          fillOpacity: 0.35,
                          fillColor: color
                      }
                  }
              });
              allGeoJsons.push(thisGeoJson);
          });
          var layerGeoJsons = L.featureGroup(allGeoJsons).addTo(map);
          map.fitBounds(layerGeoJsons.getBounds());
      });

      // Get random color
      function getRandomColor() {
          var letters = '0123456789ABCDEF'.split('');
          var color = '#';
          for (var i = 0; i < 6; i++ ) {
              color += letters[Math.floor(Math.random() * 16)];
          }
          return color;
      }
    });

</script>
